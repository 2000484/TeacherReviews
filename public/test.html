<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<title>Schoology - Test Suite</title>
		<style>
			:root {
				--bg: #202124;
				--surface: #292a2d;
				--text: #e8eaed;
				--text-secondary: #9aa0a6;
				--accent: #8ab4f8;
				--success: #81c995;
				--danger: #f28b82;
			}

			body {
				font-family: "Roboto", Arial, sans-serif;
				background: var(--bg);
				color: var(--text);
				margin: 0;
				padding: 20px;
			}

			.container {
				max-width: 800px;
				margin: 0 auto;
			}

			h1 {
				margin-top: 0;
				color: var(--accent);
			}

			.test-results {
				background: var(--surface);
				border: 1px solid #3c4043;
				border-radius: 8px;
				padding: 20px;
				margin: 20px 0;
			}

			.test-item {
				padding: 12px;
				margin: 8px 0;
				border-radius: 4px;
				border-left: 4px solid transparent;
			}

			.test-item.pass {
				background: rgba(129, 201, 149, 0.1);
				border-left-color: var(--success);
			}

			.test-item.fail {
				background: rgba(242, 139, 130, 0.1);
				border-left-color: var(--danger);
			}

			.test-item.pass::before {
				content: "‚úì ";
				color: var(--success);
				font-weight: bold;
			}

			.test-item.fail::before {
				content: "‚úó ";
				color: var(--danger);
				font-weight: bold;
			}

			.test-summary {
				background: var(--surface);
				border: 1px solid #3c4043;
				border-radius: 8px;
				padding: 20px;
				margin-top: 20px;
				text-align: center;
			}

			.stats {
				display: grid;
				grid-template-columns: repeat(3, 1fr);
				gap: 20px;
				margin: 20px 0;
			}

			.stat {
				text-align: center;
			}

			.stat-value {
				font-size: 2em;
				font-weight: bold;
				color: var(--accent);
			}

			.stat-label {
				font-size: 0.875rem;
				color: var(--text-secondary);
				margin-top: 8px;
			}

			.error-trace {
				background: rgba(242, 139, 130, 0.05);
				border: 1px solid rgba(242, 139, 130, 0.3);
				border-radius: 4px;
				padding: 8px;
				margin-top: 8px;
				font-family: monospace;
				font-size: 0.75rem;
				color: var(--danger);
				overflow-x: auto;
			}

			.status-complete {
				color: var(--success);
			}

			.status-running {
				color: var(--text-secondary);
				animation: pulse 1s infinite;
			}

			@keyframes pulse {
				0%, 100% {
					opacity: 1;
				}
				50% {
					opacity: 0.5;
				}
			}

			button {
				background: var(--accent);
				color: #202124;
				border: none;
				padding: 12px 24px;
				border-radius: 4px;
				font-size: 1rem;
				cursor: pointer;
				margin: 10px 5px;
			}

			button:hover {
				background: #aecbfa;
			}
		</style>
	</head>
	<body>
		<div class="container">
			<h1>üß™ Schoology Test Suite</h1>

			<div class="test-results" id="results"></div>

			<div class="test-summary" id="summary" style="display: none;">
				<div class="stats" id="stats"></div>
				<p id="final-status" class="status-running">Running tests...</p>
				<button onclick="location.reload()">Run Tests Again</button>
				<button onclick="history.back()">Back to App</button>
			</div>
		</div>

		<script src="tests.js"></script>
		<script>
			async function runTestsUI() {
				const resultsContainer = document.getElementById("results");
				const summaryDiv = document.getElementById("summary");
				const statsDiv = document.getElementById("stats");
				const statusDiv = document.getElementById("final-status");
				const resultsAll = [];

				// Run tests with UI updates
				for (const test of runner.tests) {
					const testItem = document.createElement("div");
					testItem.className = "test-item";

					try {
						await test.fn();
						testItem.classList.add("pass");
						testItem.innerHTML = test.name;
						resultsAll.push({ name: test.name, status: "pass" });
						runner.passed++;
					} catch (err) {
						testItem.classList.add("fail");
						testItem.innerHTML =
							test.name +
							'<div class="error-trace">' +
							err.message +
							"</div>";
						resultsAll.push({ name: test.name, status: "fail", error: err.message });
						runner.failed++;
					}

					resultsContainer.appendChild(testItem);
				}

				// Show summary
				summaryDiv.style.display = "block";
				statsDiv.innerHTML = `
					<div class="stat">
						<div class="stat-value">${runner.tests.length}</div>
						<div class="stat-label">Total Tests</div>
					</div>
					<div class="stat">
						<div class="stat-value" style="color: var(--success)">${runner.passed}</div>
						<div class="stat-label">Passed</div>
					</div>
					<div class="stat">
						<div class="stat-value" style="color: var(--danger)">${runner.failed}</div>
						<div class="stat-label">Failed</div>
					</div>
				`;

				if (runner.failed === 0) {
					statusDiv.innerHTML = "‚úì All tests passed!";
					statusDiv.className = "status-complete";
				} else {
					statusDiv.innerHTML =
						"‚ö†Ô∏è " + runner.failed + " test(s) failed";
					statusDiv.className = "status-complete";
				}

				console.log("Test Results:", resultsAll);
			}

			// Auto-run tests
			window.addEventListener("load", runTestsUI);
		</script>
	</body>
</html>
